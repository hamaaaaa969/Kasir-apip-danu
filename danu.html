<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kasir Warkotjan</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #fff8f8; margin: 0; padding: 20px; color: #333; }
    .container { max-width: 1000px; margin: 0 auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(198, 40, 40, 0.15); border: 1px solid #ffcdd2; }
    h1 { text-align: center; color: #c62828; margin-bottom: 25px; letter-spacing: 1px; }
    
    /* Search Bar */
    .search-box { width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ef9a9a; border-radius: 6px; box-sizing: border-box; }

    .menu-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px; margin-top: 10px; }
    .menu-item { border: 1px solid #ffebee; padding: 12px; border-radius: 8px; background: #fff5f5; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }
    .menu-item:hover { background: #ffebee; border-color: #ef9a9a; transform: translateY(-2px); }
    .menu-item button { background: #e53935; color: white; border: none; padding: 8px 14px; border-radius: 5px; cursor: pointer; font-weight: bold; }
    .menu-item button:hover { background: #c62828; }

    .cart { margin-top: 40px; border-top: 2px dashed #ef9a9a; padding-top: 20px; }
    .cart h2 { color: #d32f2f; margin-bottom: 15px; }
    .cart-item { display: flex; justify-content: space-between; align-items: center; margin: 8px 0; padding: 10px; background: #fff; border-radius: 6px; border-left: 4px solid #e53935; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    
    .cart-controls { display: flex; gap: 8px; align-items: center; }
    .cart-controls button { background: #ef9a9a; color: #c62828; border: none; width: 30px; height: 30px; border-radius: 50%; font-weight: bold; cursor: pointer; }
    .btn-danger { background: #f44336 !important; color: white !important; width: auto !important; border-radius: 4px !important; padding: 0 10px !important; }

    .summary-box { margin-top: 20px; padding: 15px; background: #fafafa; border-radius: 8px; }
    .total-line { display: flex; justify-content: space-between; font-size: 1.1em; margin: 5px 0; }
    .grand-total { font-size: 1.4em; font-weight: bold; color: #c62828; border-top: 1px solid #ddd; pt: 10px; }

    .payment-section { display: flex; flex-direction: column; align-items: flex-end; margin-top: 20px; gap: 10px; }
    .payment-section input { padding: 10px; width: 200px; border: 2px solid #ef9a9a; border-radius: 6px; font-size: 1.1em; }
    .kembalian { font-size: 1.2em; font-weight: bold; }

    .actions { display: flex; gap: 12px; margin-top: 25px; }
    .actions button { padding: 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; flex: 1; font-size: 16px; transition: 0.3s; }
    .btn-receipt { background: #757575; color: white; }
    .btn-print { background: #c62828; color: white; }
    .btn-print:hover { background: #8e0000; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

    /* Modal Struk */
    #strukModal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); overflow: auto; }
    .struk-content { background: white; margin: 2% auto; padding: 30px; width: 350px; border-radius: 4px; font-family: 'Courier New', Courier, monospace; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
    .struk-header { text-align: center; border-bottom: 1px dashed #333; padding-bottom: 10px; margin-bottom: 10px; }
    .struk-footer { text-align: center; border-top: 1px dashed #333; padding-top: 10px; margin-top: 15px; font-size: 0.9em; }

    @media print {
      body * { visibility: hidden; }
      .struk-content, .struk-content * { visibility: visible; }
      .struk-content { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; }
      .no-print { display: none; }
    }
  </style>
</head>
<body>

<div class="container">
  <h1>üò∏ Kasir Warkotjan üò∏</h1>

  <input type="text" id="searchInput" class="search-box" placeholder="Cari menu (e.g. Souka, V60)..." onkeyup="filterMenu()">

  <div class="menu-grid" id="menuList"></div>

  <div class="cart">
    <h2>Keranjang Belanja</h2>
    <div id="cartItems"></div>
    
    <div class="summary-box">
      <div class="total-line"><span>Subtotal</span> <span id="subtotalHarga">Rp0</span></div>
      <div class="total-line"><span>Pajak (10%)</span> <span id="pajakHarga">Rp0</span></div>
      <div class="total-line grand-total"><span>TOTAL AKHIR</span> <span id="totalAkhir">Rp0</span></div>
    </div>

    <div class="payment-section">
      <label><strong>Uang Masuk (Rp)</strong></label>
      <input type="number" id="uangMasuk" placeholder="0" oninput="hitungKembalian()">
      <div class="kembalian">Kembalian: <span id="kembalianText">Rp0</span></div>
    </div>

    <div class="actions">
      <button class="btn-receipt" onclick="tampilkanStruk()">Pratinjau Struk</button>
      <button class="btn-print" onclick="cetakStruk()">Cetak & Simpan</button>
    </div>
  </div>
</div>

<div id="strukModal">
  <div class="struk-content">
    <div id="strukDetail"></div>
    <button class="no-print" onclick="tutupStruk()" style="margin-top:20px; width:100%; padding:10px; cursor:pointer;">Tutup</button>
  </div>
</div>

<script>
  const menu = [
    { nama: "Souka", harga: 15000 }, { nama: "Asuka", harga: 15000 },
    { nama: "Tauka", harga: 15000 }, { nama: "Seika", harga: 15000 },
    { nama: "Shoko", harga: 17000 }, { nama: "Nigai", harga: 15000 },
    { nama: "Yuzu", harga: 17000 }, { nama: "Ichika", harga: 15000 },
    { nama: "Sayaka", harga: 22000 }, { nama: "Midoriya", harga: 19000 },
    { nama: "Akaame", harga: 15000 }, { nama: "Tohru", harga: 15000 },
    { nama: "Tatsumaki", harga: 15000 }, { nama: "Tesshu", harga: 10000 },
    { nama: "Amai", harga: 8000 }, { nama: "Mutto", harga: 8000 },
    { nama: "Remon", harga: 10000 }, { nama: "Ichigo", harga: 10000 },
    { nama: "Maomao", harga: 15000 }, { nama: "V60", harga: 20000 },
    { nama: "Vietnam Drip", harga: 15000 }, { nama: "Akira", harga: 15000 },
    { nama: "Haru", harga: 15000 }, { nama: "Yoru", harga: 15000 },
    { nama: "Mont Black", harga: 20000 },{ nama: "Nasi Kaarage", harga: 18000 },
    { nama: "Nasi Kari Katsu", harga: 18000 },{ nama: "Nasi Telor Warko", harga: 15000 },
    { nama: "Nasi Indomie", harga: 15000 },
    { nama: "Nasi Indomie Basic", harga: 13000 }, { nama: "Chicken Wing!", harga: 20000 },
    { nama: "Kentang Goreng", harga: 15000 }, { nama: "Choco Toast", harga: 15000 },
    { nama: "egg toast", harga: 15000 }, { nama: "bread of dthe day!", harga: 8000 },
    { nama: "Tubruk", harga: 10000 }, { nama: "Tesshu", harga: 10000 },
    { nama: "Ginger Tesshu", harga: 12000 }, { nama: "Honey Lemon Tea", harga: 15000 },
    { nama: "Americano", harga: 15000 }, { nama: "kopi latte", harga: 15000 },
  ];

  let keranjang = [];

  function formatIDR(angka) {
    return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits: 0 }).format(angka);
  }

  function renderMenu(filter = "") {
    const menuList = document.getElementById('menuList');
    menuList.innerHTML = '';
    menu.filter(item => item.nama.toLowerCase().includes(filter.toLowerCase())).forEach(item => {
      const div = document.createElement('div');
      div.className = 'menu-item';
      div.innerHTML = `
        <div><strong>${item.nama}</strong><br>${formatIDR(item.harga)}</div>
        <button onclick="tambahKeKeranjang('${item.nama}', ${item.harga})">+</button>
      `;
      menuList.appendChild(div);
    });
  }

  function filterMenu() {
    const val = document.getElementById('searchInput').value;
    renderMenu(val);
  }

  function tambahKeKeranjang(nama, harga) {
    const existing = keranjang.find(item => item.nama === nama);
    if (existing) { existing.jumlah += 1; } 
    else { keranjang.push({ nama, harga, jumlah: 1 }); }
    renderKeranjang();
  }

  function ubahJumlah(index, delta) {
    keranjang[index].jumlah += delta;
    if (keranjang[index].jumlah <= 0) keranjang.splice(index, 1);
    renderKeranjang();
  }

  function renderKeranjang() {
    const container = document.getElementById('cartItems');
    let subtotal = 0;
    container.innerHTML = keranjang.length === 0 ? "<p>Keranjang masih kosong...</p>" : "";

    keranjang.forEach((item, index) => {
      subtotal += item.harga * item.jumlah;
      container.innerHTML += `
        <div class="cart-item">
          <div><strong>${item.nama}</strong><br>${formatIDR(item.harga)} x ${item.jumlah}</div>
          <div class="cart-controls">
            <button onclick="ubahJumlah(${index}, -1)">-</button>
            <button onclick="ubahJumlah(${index}, 1)">+</button>
            <button class="btn-danger" onclick="ubahJumlah(${index}, -${item.jumlah})">üóëÔ∏è</button>
          </div>
        </div>
      `;
    });

    const pajak = Math.round(subtotal * 0.1);
    const total = subtotal + pajak;

    document.getElementById('subtotalHarga').textContent = formatIDR(subtotal);
    document.getElementById('pajakHarga').textContent = formatIDR(pajak);
    document.getElementById('totalAkhir').textContent = formatIDR(total);
    hitungKembalian();
  }

  function hitungKembalian() {
    const totalText = document.getElementById('totalAkhir').textContent.replace(/[^0-9]/g, '');
    const total = parseInt(totalText) || 0;
    const uang = parseInt(document.getElementById('uangMasuk').value) || 0;
    const res = document.getElementById('kembalianText');

    if (uang >= total && total > 0) {
      res.textContent = formatIDR(uang - total);
      res.style.color = "#2e7d32";
    } else {
      res.textContent = "Uang kurang";
      res.style.color = "#d32f2f";
    }
  }

  function buatStrukHTML() {
    const subtotal = document.getElementById('subtotalHarga').textContent;
    const pajak = document.getElementById('pajakHarga').textContent;
    const total = document.getElementById('totalAkhir').textContent;
    const uang = formatIDR(document.getElementById('uangMasuk').value || 0);
    const kembalian = document.getElementById('kembalianText').textContent;

    let items = keranjang.map(i => `<div>${i.nama.padEnd(15)} x${i.jumlah} ${formatIDR(i.harga*i.jumlah).padStart(12)}</div>`).join('');

    return `
      <div class="struk-header">
        <h3 style="margin:0">WARKOTJAN</h3>
        <p style="font-size:12px">Jl. Pedas Mantap No. 69<br>${new Date().toLocaleString('id-ID')}</p>
      </div>
      <div style="font-size:12px; white-space: pre;">${items}</div>
      <div style="border-top:1px dashed #333; margin-top:10px; font-size:12px;">
        <div style="display:flex; justify-content:space-between"><span>Subtotal:</span><span>${subtotal}</span></div>
        <div style="display:flex; justify-content:space-between"><span>Pajak (10%):</span><span>${pajak}</span></div>
        <div style="display:flex; justify-content:space-between; font-weight:bold"><span>TOTAL:</span><span>${total}</span></div>
        <div style="display:flex; justify-content:space-between; margin-top:5px"><span>Bayar:</span><span>${uang}</span></div>
        <div style="display:flex; justify-content:space-between"><span>Kembali:</span><span>${kembalian}</span></div>
      </div>
      <div class="struk-footer">Terima Kasih!üò∏</div>
    `;
  }

  function tampilkanStruk() {
    if (keranjang.length === 0) return alert("Keranjang kosong!");
    document.getElementById('strukDetail').innerHTML = buatStrukHTML();
    document.getElementById('strukModal').style.display = "block";
  }

  function tutupStruk() { document.getElementById('strukModal').style.display = "none"; }

  function cetakStruk() {
    const total = parseInt(document.getElementById('totalAkhir').textContent.replace(/[^0-9]/g, ''));
    const uang = parseInt(document.getElementById('uangMasuk').value) || 0;
    
    if (keranjang.length === 0 || uang < total) return alert("Periksa kembali pesanan dan pembayaran!");
    
    document.getElementById('strukDetail').innerHTML = buatStrukHTML();
    window.print();
  }

  // Inisialisasi
  renderMenu();
</script>

</body>
</html>